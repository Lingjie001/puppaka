# PUPPAKA é¡¹ç›®è¯¦ç»†è¯´æ˜ä¹¦

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

**PUPPAKA** æ˜¯ä¸€ä¸ªåŸºäº Node.js çš„ä¸ªäººåšå®¢å’Œä½œå“é›†ç½‘ç«™ï¼Œé‡‡ç”¨æ·±è‰²ç§‘æŠ€é£æ ¼è®¾è®¡ï¼Œå…·æœ‰ç°ä»£åŒ–çš„ç”¨æˆ·ç•Œé¢å’Œå®Œæ•´çš„å†…å®¹ç®¡ç†åŠŸèƒ½ã€‚

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æ ¸å¿ƒæŠ€æœ¯æ ˆ

| å±‚çº§ | æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|------|
| **åç«¯æ¡†æ¶** | Express.js | ^4.18.2 | Web æœåŠ¡å™¨æ¡†æ¶ |
| **æ•°æ®åº“** | SQLite3 | ^5.1.7 | è½»é‡çº§å…³ç³»å‹æ•°æ®åº“ |
| **æ¨¡æ¿å¼•æ“** | EJS | ^3.1.9 | æœåŠ¡ç«¯ HTML æ¸²æŸ“ |
| **å¯†ç åŠ å¯†** | bcryptjs | ^2.4.3 | ç”¨æˆ·å¯†ç å®‰å…¨å­˜å‚¨ |
| **æ–‡ä»¶ä¸Šä¼ ** | multer | ^1.4.5-lts.1 | å¤„ç†å›¾ç‰‡ä¸Šä¼  |
| **å®‰å…¨é˜²æŠ¤** | helmet | ^7.1.0 | å®‰å…¨ HTTP å¤´è®¾ç½® |
| **é€Ÿç‡é™åˆ¶** | express-rate-limit | ^7.1.5 | API è¯·æ±‚é™æµ |
| **ä¼šè¯ç®¡ç†** | express-session | ^1.18.0 | ç”¨æˆ·ä¼šè¯ç®¡ç† |
| **å‹ç¼©** | compression | ^1.7.4 | å“åº”å†…å®¹å‹ç¼© |
| **å¼€å‘å·¥å…·** | nodemon | ^3.0.3 | å¼€å‘çƒ­é‡è½½ |

### ç³»ç»Ÿè¦æ±‚

- **Node.js**: >= 18.0.0
- **æ“ä½œç³»ç»Ÿ**: Linux/macOS/Windows
- **å†…å­˜**: æœ€ä½ 512MB RAM
- **å­˜å‚¨**: è‡³å°‘ 100MB å¯ç”¨ç©ºé—´

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
puppaka-site/
â”œâ”€â”€ ğŸ“„ æ ¸å¿ƒæ–‡ä»¶
â”‚   â”œâ”€â”€ server.js          # ä¸»æœåŠ¡å™¨å…¥å£ (339 è¡Œ)
â”‚   â”œâ”€â”€ database.js        # æ•°æ®åº“æ“ä½œç±» (426 è¡Œ)
â”‚   â”œâ”€â”€ package.json       # é¡¹ç›®é…ç½®å’Œä¾èµ–
â”‚   â”œâ”€â”€ setup.js           # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â”‚   â””â”€â”€ .env.example       # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”‚
â”œâ”€â”€ ğŸ›£ï¸ è·¯ç”± (routes/)
â”‚   â”œâ”€â”€ admin.js           # ç®¡ç†åå°è·¯ç”± (308 è¡Œ)
â”‚   â””â”€â”€ api.js             # API æ¥å£è·¯ç”± (62 è¡Œ)
â”‚
â”œâ”€â”€ ğŸ¨ è§†å›¾æ¨¡æ¿ (views/)
â”‚   â”œâ”€â”€ layout.ejs         # ä¸»å¸ƒå±€æ¨¡æ¿
â”‚   â”œâ”€â”€ index.ejs          # é¦–é¡µ
â”‚   â”œâ”€â”€ blog.ejs           # åšå®¢åˆ—è¡¨é¡µ
â”‚   â”œâ”€â”€ post.ejs           # æ–‡ç« è¯¦æƒ…é¡µ
â”‚   â”œâ”€â”€ portfolio.ejs      # ä½œå“é›†åˆ—è¡¨é¡µ
â”‚   â”œâ”€â”€ project.ejs        # é¡¹ç›®è¯¦æƒ…é¡µ
â”‚   â”œâ”€â”€ about.ejs          # å…³äºé¡µé¢
â”‚   â”œâ”€â”€ contact.ejs        # è”ç³»é¡µé¢
â”‚   â”œâ”€â”€ error.ejs          # é”™è¯¯é¡µé¢
â”‚   â””â”€â”€ admin/             # åå°ç®¡ç†æ¨¡æ¿
â”‚       â”œâ”€â”€ login.ejs      # ç™»å½•é¡µ
â”‚       â”œâ”€â”€ dashboard.ejs  # ä»ªè¡¨ç›˜
â”‚       â”œâ”€â”€ posts.ejs      # æ–‡ç« ç®¡ç†
â”‚       â”œâ”€â”€ post-form.ejs  # æ–‡ç« è¡¨å•
â”‚       â”œâ”€â”€ projects.ejs   # é¡¹ç›®ç®¡ç†
â”‚       â”œâ”€â”€ project-form.ejs # é¡¹ç›®è¡¨å•
â”‚       â”œâ”€â”€ contacts.ejs   # è”ç³»è®°å½•
â”‚       â””â”€â”€ settings.ejs   # è®¾ç½®é¡µé¢
â”‚
â”œâ”€â”€ ğŸ¨ é™æ€èµ„æº (public/)
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â”œâ”€â”€ style.css      # ä¸»è¦æ ·å¼ (æ·±è‰²ä¸»é¢˜)
â”‚   â”‚   â””â”€â”€ pages.css      # é¡µé¢ç‰¹å®šæ ·å¼
â”‚   â””â”€â”€ js/
â”‚       â””â”€â”€ main.js        # å®¢æˆ·ç«¯ JavaScript
â”‚
â”œâ”€â”€ ğŸ“¦ æ•°æ®å­˜å‚¨
â”‚   â”œâ”€â”€ data/              # æ•°æ®åº“æ–‡ä»¶ç›®å½•
â”‚   â”‚   â””â”€â”€ puppaka.db     # SQLite æ•°æ®åº“æ–‡ä»¶
â”‚   â””â”€â”€ uploads/           # ä¸Šä¼ æ–‡ä»¶ç›®å½•
â”‚       â””â”€â”€ (ç”¨æˆ·ä¸Šä¼ çš„å›¾ç‰‡)
â”‚
â””â”€â”€ ğŸ“¦ node_modules/       # ä¾èµ–åŒ…ç›®å½•
```

---

## ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡

### æ•°æ®è¡¨ç»“æ„

#### 1. æ–‡ç« è¡¨ (posts)
```sql
CREATE TABLE posts (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  title TEXT NOT NULL,           -- æ–‡ç« æ ‡é¢˜
  slug TEXT UNIQUE NOT NULL,     -- URL å‹å¥½çš„æ ‡è¯†ç¬¦
  content TEXT NOT NULL,         -- æ–‡ç« å†…å®¹ (æ”¯æŒ Markdown)
  excerpt TEXT,                  -- æ–‡ç« æ‘˜è¦
  featured_image TEXT,           -- ç‰¹è‰²å›¾ç‰‡è·¯å¾„
  category TEXT,                 -- åˆ†ç±»
  tags TEXT,                     -- æ ‡ç­¾ (é€—å·åˆ†éš”)
  published INTEGER DEFAULT 1,   -- å‘å¸ƒçŠ¶æ€ (1=å‘å¸ƒ, 0=è‰ç¨¿)
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

#### 2. é¡¹ç›®è¡¨ (projects)
```sql
CREATE TABLE projects (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  title TEXT NOT NULL,           -- é¡¹ç›®æ ‡é¢˜
  slug TEXT UNIQUE NOT NULL,     -- URL å‹å¥½çš„æ ‡è¯†ç¬¦
  description TEXT NOT NULL,     -- é¡¹ç›®ç®€ä»‹
  content TEXT,                  -- é¡¹ç›®è¯¦ç»†å†…å®¹
  featured_image TEXT,           -- ç‰¹è‰²å›¾ç‰‡è·¯å¾„
  images TEXT,                   -- å›¾ç‰‡é›†åˆ (JSON)
  category TEXT,                 -- åˆ†ç±»
  technologies TEXT,             -- æŠ€æœ¯æ ˆ (é€—å·åˆ†éš”)
  link TEXT,                     -- é¡¹ç›®é“¾æ¥
  github TEXT,                   -- GitHub é“¾æ¥
  published INTEGER DEFAULT 1,   -- å‘å¸ƒçŠ¶æ€
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

#### 3. è”ç³»è®°å½•è¡¨ (contacts)
```sql
CREATE TABLE contacts (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name TEXT NOT NULL,            -- è”ç³»äººå§“å
  email TEXT NOT NULL,           -- è”ç³»é‚®ç®±
  subject TEXT,                  -- ä¸»é¢˜
  message TEXT NOT NULL,         -- æ¶ˆæ¯å†…å®¹
  read INTEGER DEFAULT 0,        -- æ˜¯å¦å·²è¯»
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

#### 4. ç”¨æˆ·è¡¨ (users)
```sql
CREATE TABLE users (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  username TEXT UNIQUE NOT NULL, -- ç”¨æˆ·å
  password TEXT NOT NULL,        -- åŠ å¯†å¯†ç  (bcrypt)
  email TEXT,                    -- é‚®ç®±
  role TEXT DEFAULT 'admin',     -- è§’è‰²
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

### é»˜è®¤ç®¡ç†å‘˜è´¦å·
- **ç”¨æˆ·å**: `admin`
- **å¯†ç **: `admin123`
- **é‚®ç®±**: `admin@puppaka.com`

**âš ï¸ å®‰å…¨æç¤º**: é¦–æ¬¡ç™»å½•åè¯·ç«‹å³ä¿®æ”¹é»˜è®¤å¯†ç ï¼

---

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡ (.env)

| å˜é‡å | è¯´æ˜ | é»˜è®¤å€¼ | å¿…éœ€ |
|--------|------|--------|------|
| `PORT` | æœåŠ¡å™¨ç«¯å£ | 3000 | å¦ |
| `SESSION_SECRET` | ä¼šè¯åŠ å¯†å¯†é’¥ | (è‡ªåŠ¨ç”Ÿæˆ) | **æ˜¯** |
| `NODE_ENV` | è¿è¡Œç¯å¢ƒ | development | å¦ |
| `HOSTINGER` | Hostinger æ‰˜ç®¡æ ‡å¿— | false | å¦ |

### é…ç½®æ–‡ä»¶ç¤ºä¾‹

```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡ç¤ºä¾‹æ–‡ä»¶
cp .env.example .env

# ç¼–è¾‘ .env æ–‡ä»¶
PORT=3000
SESSION_SECRET=your-super-secret-key-here
NODE_ENV=production
```

---

## ğŸš€ éƒ¨ç½²æŒ‡å—

### æœ¬åœ°å¼€å‘ç¯å¢ƒ

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd /root/.openclaw/workspace/puppaka-site

# 2. å®‰è£…ä¾èµ–
npm install

# 3. é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œè®¾ç½® SESSION_SECRET

# 4. å¯åŠ¨å¼€å‘æœåŠ¡å™¨ (å¸¦çƒ­é‡è½½)
npm run dev

# 5. è®¿é—®ç½‘ç«™
# æµè§ˆå™¨æ‰“å¼€: http://localhost:3000
```

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

```bash
# 1. è®¾ç½®ç”Ÿäº§ç¯å¢ƒå˜é‡
export NODE_ENV=production
export SESSION_SECRET=your-production-secret-key

# 2. å¯åŠ¨æœåŠ¡å™¨
npm start

# æˆ–ä½¿ç”¨ PM2 è¿›ç¨‹ç®¡ç†å™¨
pm2 start server.js --name puppaka
```

---

## ğŸ”’ å®‰å…¨ç‰¹æ€§

### å·²å®æ–½çš„å®‰å…¨æªæ–½

1. **Helmet ä¸­é—´ä»¶**
   - è®¾ç½®å®‰å…¨ HTTP å¤´
   - å†…å®¹å®‰å…¨ç­–ç•¥ (CSP)
   - é˜²æ­¢ XSS æ”»å‡»

2. **é€Ÿç‡é™åˆ¶**
   - æ¯ IP æ¯ 15 åˆ†é’Ÿæœ€å¤š 100 ä¸ªè¯·æ±‚
   - é˜²æ­¢æš´åŠ›ç ´è§£å’Œ DDoS

3. **å¯†ç åŠ å¯†**
   - ä½¿ç”¨ bcryptjs è¿›è¡Œå¯†ç å“ˆå¸Œ
   - 10 è½® salt è¿­ä»£

4. **ä¼šè¯å®‰å…¨**
   - åŠ å¯†ä¼šè¯ cookie
   - ç”Ÿäº§ç¯å¢ƒå¯ç”¨ secure æ ‡å¿—
   - 24 å°æ—¶ä¼šè¯è¿‡æœŸ

5. **è¾“å…¥éªŒè¯**
   - SQL æ³¨å…¥é˜²æŠ¤ (å‚æ•°åŒ–æŸ¥è¯¢)
   - æ–‡ä»¶ä¸Šä¼ ç±»å‹é™åˆ¶ (ä»…å›¾ç‰‡)
   - æ–‡ä»¶å¤§å°é™åˆ¶ (5MB)

6. **é”™è¯¯å¤„ç†**
   - ä¸å‘å®¢æˆ·ç«¯æš´éœ²å †æ ˆè·Ÿè¸ª
   - ç»Ÿä¸€çš„é”™è¯¯é¡µé¢

---

## ğŸ“± åŠŸèƒ½æ¨¡å—

### å‰å°åŠŸèƒ½

| é¡µé¢ | è·¯å¾„ | åŠŸèƒ½æè¿° |
|------|------|----------|
| **é¦–é¡µ** | `/` | å±•ç¤ºæœ€æ–°æ–‡ç« å’Œé¡¹ç›® |
| **åšå®¢** | `/blog` | æ–‡ç« åˆ—è¡¨ï¼Œæ”¯æŒåˆ†é¡µ |
| **æ–‡ç« è¯¦æƒ…** | `/blog/:slug` | å•ç¯‡æ–‡ç« å±•ç¤ºï¼Œç›¸å…³æ–‡ç« æ¨è |
| **ä½œå“é›†** | `/portfolio` | é¡¹ç›®åˆ—è¡¨å±•ç¤º |
| **é¡¹ç›®è¯¦æƒ…** | `/portfolio/:slug` | é¡¹ç›®è¯¦ç»†ä»‹ç» |
| **å…³äº** | `/about` | ä¸ªäººä»‹ç»é¡µé¢ |
| **è”ç³»** | `/contact` | è”ç³»è¡¨å•æäº¤ |

### ç®¡ç†åå°åŠŸèƒ½

| åŠŸèƒ½ | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| **ç™»å½•** | `/admin/login` | ç®¡ç†å‘˜ç™»å½• |
| **ä»ªè¡¨ç›˜** | `/admin` | æ•°æ®ç»Ÿè®¡æ¦‚è§ˆ |
| **æ–‡ç« ç®¡ç†** | `/admin/posts` | CRUD æ–‡ç«  |
| **é¡¹ç›®ç®¡ç†** | `/admin/projects` | CRUD é¡¹ç›® |
| **è”ç³»è®°å½•** | `/admin/contacts` | æŸ¥çœ‹è”ç³»è¡¨å• |
| **è®¾ç½®** | `/admin/settings` | ä¿®æ”¹å¯†ç ç­‰ |

### API æ¥å£

| æ¥å£ | æ–¹æ³• | è·¯å¾„ | æè¿° |
|------|------|------|------|
| è·å–æ–‡ç« åˆ—è¡¨ | GET | `/api/posts` | è¿”å›æ‰€æœ‰å·²å‘å¸ƒæ–‡ç«  |
| è·å–å•ç¯‡æ–‡ç«  | GET | `/api/posts/:slug` | è¿”å›æŒ‡å®šæ–‡ç« è¯¦æƒ… |
| è·å–é¡¹ç›®åˆ—è¡¨ | GET | `/api/projects` | è¿”å›æ‰€æœ‰å·²å‘å¸ƒé¡¹ç›® |
| è·å–å•ä¸ªé¡¹ç›® | GET | `/api/projects/:slug` | è¿”å›æŒ‡å®šé¡¹ç›®è¯¦æƒ… |
| å¥åº·æ£€æŸ¥ | GET | `/api/health` | æœåŠ¡å™¨çŠ¶æ€æ£€æŸ¥ |

---

## ğŸ› ä¿®å¤è®°å½•

### å·²ä¿®å¤é—®é¢˜

#### 1. setup.js æ–¹æ³•è°ƒç”¨é”™è¯¯
- **é—®é¢˜**: ä½¿ç”¨ä¸å­˜åœ¨çš„æ–¹æ³• `db.createPost()` å’Œ `db.createProject()`
- **ä¿®å¤**: æ”¹ä¸ºæ­£ç¡®çš„ `db.savePost()` å’Œ `db.saveProject()`
- **ä½ç½®**: `setup.js:480, 490`

#### 2. server.js ç¡¬ç¼–ç æ•°æ®é—®é¢˜
- **é—®é¢˜**: é¦–é¡µã€åšå®¢é¡µã€ä½œå“é›†é¡µé¢ä½¿ç”¨ç¡¬ç¼–ç ç¤ºä¾‹æ•°æ®
- **ä¿®å¤**: æ”¹ä¸ºä»æ•°æ®åº“åŠ¨æ€è·å–æ•°æ®
- **ä½ç½®**: `server.js:84-152, 155-207, 225-270`

#### 3. æ¨¡æ¿å˜é‡ç¼ºå¤±
- **é—®é¢˜**: éƒ¨åˆ†è·¯ç”±æœªä¼ é€’å¿…éœ€çš„æ¨¡æ¿å˜é‡ (path, title, description)
- **ä¿®å¤**: ä¸ºæ‰€æœ‰è·¯ç”±æ·»åŠ å®Œæ•´çš„ä¸Šä¸‹æ–‡å˜é‡
- **ä½ç½®**: `server.js` å¤šä¸ªè·¯ç”±å¤„ç†å™¨

#### 4. æ•°æ®ç›®å½•ç¼ºå¤±
- **é—®é¢˜**: `data/` å’Œ `uploads/` ç›®å½•å¯èƒ½ä¸å­˜åœ¨
- **ä¿®å¤**: æ·»åŠ ç›®å½•åˆ›å»ºå‘½ä»¤åˆ°éƒ¨ç½²æµç¨‹
- **å‘½ä»¤**: `mkdir -p data uploads`

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### å·²å®æ–½çš„ä¼˜åŒ–

1. **å“åº”å‹ç¼©**
   - å¯ç”¨ Gzip å‹ç¼©
   - å‡å°‘ä¼ è¾“æ•°æ®é‡

2. **é™æ€æ–‡ä»¶ç¼“å­˜**
   - CSS/JS æ–‡ä»¶é•¿æœŸç¼“å­˜
   - å›¾ç‰‡èµ„æºä¼˜åŒ–

3. **æ•°æ®åº“ä¼˜åŒ–**
   - å•ä¾‹æ¨¡å¼é¿å…é‡å¤è¿æ¥
   - åˆç†çš„ç´¢å¼•è®¾è®¡

4. **å›¾ç‰‡å¤„ç†**
   - ä¸Šä¼ æ–‡ä»¶å¤§å°é™åˆ¶ 5MB
   - æ”¯æŒ WebPã€JPEGã€PNGã€GIF æ ¼å¼

---

## ğŸ› ï¸ ç»´æŠ¤æŒ‡å—

### æ—¥å¸¸ç»´æŠ¤ä»»åŠ¡

```bash
# æŸ¥çœ‹æ—¥å¿—
pm2 logs puppaka

# é‡å¯æœåŠ¡
pm2 restart puppaka

# å¤‡ä»½æ•°æ®åº“
cp data/puppaka.db data/puppaka.db.backup.$(date +%Y%m%d)

# æ›´æ–°ä¾èµ–
npm update
```

### æ•°æ®åº“å¤‡ä»½

```bash
# SQLite å¤‡ä»½å‘½ä»¤
sqlite3 data/puppaka.db ".backup 'data/puppaka.db.backup'"

# æˆ–è€…ç®€å•å¤åˆ¶
cp data/puppaka.db backups/puppaka-$(date +%Y%m%d-%H%M%S).db
```

---

## ğŸ“ è”ç³»æ–¹å¼

- **é¡¹ç›®åœ°å€**: https://github.com/Lingjie001/puppaka
- **ä½œè€…**: Lingjie001
- **é‚®ç®±**: guanghui0711@gmail.com

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº MIT è®¸å¯è¯å¼€æºã€‚

---

## ğŸ”„ ç‰ˆæœ¬å†å²

### v1.0.0 (å½“å‰ç‰ˆæœ¬)
- âœ¨ åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- ğŸ“ åšå®¢ç³»ç»Ÿ
- ğŸ¨ ä½œå“é›†å±•ç¤º
- ğŸ” ç®¡ç†åå°
- ğŸ“± å“åº”å¼è®¾è®¡
- ğŸ”’ å®‰å…¨åŠŸèƒ½

---

## ğŸ“š ç›¸å…³èµ„æº

### æ–‡æ¡£é“¾æ¥
- [Express.js å®˜æ–¹æ–‡æ¡£](https://expressjs.com/)
- [EJS æ¨¡æ¿å¼•æ“](https://ejs.co/)
- [SQLite æ–‡æ¡£](https://www.sqlite.org/docs.html)
- [Helmet å®‰å…¨ä¸­é—´ä»¶](https://helmetjs.github.io/)

### è®¾è®¡å‚è€ƒ
- æ·±è‰²ç§‘æŠ€é£æ ¼ä¸»é¢˜
- ç´«è‰²æ¸å˜å¼ºè°ƒè‰² (#6366f1 â†’ #8b5cf6)
- Inter + JetBrains Mono å­—ä½“ç»„åˆ

---

*æ–‡æ¡£ç”Ÿæˆæ—¶é—´: 2026-02-07*
*é¡¹ç›®ç‰ˆæœ¬: v1.0.0*
